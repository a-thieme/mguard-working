general
{
    network /ndn/
    site /c-site
    router /%C1.Router/cs/c
    lsa-refresh-time 1800
    lsa-interest-lifetime 4
    sync-protocol psync
    sync-interest-lifetime 60000
    state-dir /tmp/minindn/c/log
}
neighbors
{
    hello-retries 3
    hello-timeout 1
    hello-interval 60
    adj-lsa-build-interval 10
    face-dataset-fetch-tries 3
    face-dataset-fetch-interval 3600
    neighbor
    {
        name /ndn/arizona-site/%C1.Router/cs/arizona
        face-uri udp://10.0.0.78
        link-cost 33
    }
    neighbor
    {
        name /ndn/uiuc-site/%C1.Router/cs/uiuc
        face-uri udp://10.0.0.165
        link-cost 9
    }
    neighbor
    {
        name /ndn/a-site/%C1.Router/cs/a
        face-uri udp://10.0.0.9
        link-cost 17
    }
    neighbor
    {
        name /ndn/urjc-site/%C1.Router/cs/urjc
        face-uri udp://10.0.0.169
        link-cost 86
    }
    neighbor
    {
        name /ndn/mumbai_aws-site/%C1.Router/cs/mumbai_aws
        face-uri udp://10.0.0.174
        link-cost 122
    }
    neighbor
    {
        name /ndn/aveiro-site/%C1.Router/cs/aveiro
        face-uri udp://10.0.0.114
        link-cost 75
    }
    neighbor
    {
        name /ndn/univh2c-site/%C1.Router/cs/univh2c
        face-uri udp://10.0.0.178
        link-cost 75
    }
    neighbor
    {
        name /ndn/ufba-site/%C1.Router/cs/ufba
        face-uri udp://10.0.0.182
        link-cost 65
    }
    neighbor
    {
        name /ndn/uclacs-site/%C1.Router/cs/uclacs
        face-uri udp://10.0.0.185
        link-cost 30
    }
    neighbor
    {
        name /ndn/qub-site/%C1.Router/cs/qub
        face-uri udp://10.0.0.189
        link-cost 60
    }
    neighbor
    {
        name /ndn/b-site/%C1.Router/cs/b
        face-uri udp://10.0.0.121
        link-cost 30
    }
}
hyperbolic
{
    state off
    radius 19.4268
    angle 4.31067
}
fib
{
    max-faces-per-prefix 3
    routing-calc-interval 15
}
advertising
{
    prefix /ndn/c-site/c
}
security
{
    validator
    {
        rule
        {
            id "NLSR Hello Rule"
            for data
            filter
            {
                type name
                regex ^[^<nlsr><INFO>]*<nlsr><INFO><><>$
            }
            checker
            {
                type customized
                sig-type ecdsa-sha256
                key-locator
                {
                    type name
                    hyper-relation
                    {
                        k-regex "^([^<KEY><nlsr>]*)<nlsr><KEY><>{1,3}$"
                        k-expand \\1
                        h-relation equal
                        p-regex ^([^<nlsr><INFO>]*)<nlsr><INFO><><>$
                        p-expand \\1
                    }
                }
            }
        }
        rule
        {
            id "NLSR LSA Rule"
            for data
            filter
            {
                type name
                regex ^[^<nlsr><LSA>]*<nlsr><LSA>
            }
            checker
            {
                type customized
                sig-type ecdsa-sha256
                key-locator
                {
                    type name
                    hyper-relation
                    {
                        k-regex "^([^<KEY><nlsr>]*)<nlsr><KEY><>{1,3}$"
                        k-expand \\1
                        h-relation equal
                        p-regex ^<localhop>([^<nlsr><LSA>]*)<nlsr><LSA>(<>*)<><><><>$
                        p-expand \\1\\2
                    }
                }
            }
        }
        rule
        {
            id "NLSR datasets"
            for data
            filter
            {
                type name
                regex ^[^<nlsr>]*<nlsr>[<lsdb><routing-table>]
            }
            checker
            {
                type customized
                sig-type ecdsa-sha256
                key-locator
                {
                    type name
                    hyper-relation
                    {
                        k-regex "^([^<KEY>]*)<KEY><>{1,3}$"
                        k-expand \\1
                        h-relation equal
                        p-regex ^([^<nlsr>]*)<nlsr>[<lsdb><routing-table>]
                        p-expand \\1
                    }
                }
            }
        }
        rule
        {
            id "NLSR Hierarchy Exception Rule"
            for data
            filter
            {
                type name
                regex ^[^<KEY><%C1.Router>]*<%C1.Router>[^<KEY><nlsr>]*<KEY><><><>$
            }
            checker
            {
                type customized
                sig-type ecdsa-sha256
                key-locator
                {
                    type name
                    hyper-relation
                    {
                        k-regex "^([^<KEY><%C1.Operator>]*)<%C1.Operator>[^<KEY>]*<KEY><>{1,3}$"
                        k-expand \\1
                        h-relation equal
                        p-regex ^([^<KEY><%C1.Router>]*)<%C1.Router>[^<KEY>]*<KEY><><><>$
                        p-expand \\1
                    }
                }
            }
        }
        rule
        {
            id "NLSR Hierarchical Rule"
            for data
            filter
            {
                type name
                regex ^[^<KEY>]*<KEY><><><>$
            }
            checker
            {
                type hierarchical
                sig-type ecdsa-sha256
            }
        }
        trust-anchor
        {
            type any
        }
    }
    prefix-update-validator
    {
        rule
        {
            id "NLSR ControlCommand Rule"
            for interest
            filter
            {
                type name
                regex ^<localhost><nlsr><prefix-update>[<advertise><withdraw>]<><><>$
            }
            checker
            {
                type customized
                sig-type ecdsa-sha256
                key-locator
                {
                    type name
                    regex "^([^<KEY><%C1.Operator>]*)<%C1.Operator>[^<KEY>]*<KEY><>{1,3}$"
                }
            }
        }
        rule
        {
            id "NLSR Hierarchy Rule"
            for data
            filter
            {
                type name
                regex ^[^<KEY>]*<KEY><><><>$
            }
            checker
            {
                type hierarchical
                sig-type ecdsa-sha256
            }
        }
        trust-anchor
        {
            type any
        }
    }
}
